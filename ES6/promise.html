<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>promise</title>
</head>
<body>
<script src="../jQuery/jquery-3.3.1.js"></script>
<script>
//    $.get("musicdata.json",function (res) {       //jquery实现ajax
//        console.log(res);
//    })



//    $.get("a.json",function (res) {            //嵌套请求，速度慢，不好管理
//        console.log(res);
//        $.get("b.json",function (res) {
//            console.log(res);
//            $.get("c.json",function (res) {
//                console.log(res);
//            })
//        })
//    })



//    let prom = new Promise(function (resolved,rejected) {
//        $.get("a.json",function (res) {
//            console.log(res);
////            resolved();         //成功
//            rejected();           //失败
//        })
//    }).then(function () {
//        $.get("b.json",function (res) {
//            console.log(res);
//        })
//    },function () {
//        console.log("error1");
//    })
////    ).catch(function () {
////            console.log("error");
////    });




//    let prom = function (url, callback) {
//        return new Promise(function (resolved,rejected) {
//            $.get(url,function (res) {
//                if(callback){
//                    callback();
//                }
//                resolved(res);
//            })
//        })
//    };
//
//    prom("a.json").then(function (res) {
//        console.log(res);
//        return prom("b.json",function () {
//            console.log("aaaa");
//        });
//    }).then(function (res) {
//        console.log(res);
//        return prom("c.json");
//    }).then(function (res) {
//        console.log(res);
//    });






    let prom1 = new Promise(function (resolved,rejected) {
        $.get("a.json",function (res) {
            console.log(res);
            rejected();
        })
    });

    let prom2 = new Promise(function (resolved,rejected) {
        $.get("b.json",function (res) {
            console.log(res);
            resolved();
        })
    });

    let prom3 = new Promise(function (resolved,rejected) {
        $.get("c.json",function (res) {
            console.log(res);
            resolved();
        })
    });

//    Promise.all([prom1,prom2,prom3]).then(function () {
//        console.log("done");
//    },function () {
//        console.log("error");
//    })


    Promise.race([prom1,prom2,prom3]).then(function () {           //截获第一个完成的
        console.log("done");
    },function () {
        console.log("error");
    })
</script>
</body>
</html>